(cl:in-package #:cl-data-structures.utils)


(-> fixnum-hash (fixnum) (unsigned-byte 32))
(defun fixnum-hash (a)
  (declare (optimize (speed 3) (safety 0)))
  (flet ((op1 (a f1 f2)
           (declare (type fixnum a f1 f2))
           (ldb (byte 32 0) (+ a f1 (ash a f2))))
         (op2 (a f1 f2)
           (declare (type fixnum a f1 f2))
           (ldb (byte 32 0) (logxor a f1 (ash a f2)))))
    (declare (inline op1 op2))
    (~> (op1 a #x7ed55d16 12) (op2 #xc761c23c -19)
        (op1 #x165667b1 5)    (op2 #xd3a2646c 9)
        (op1 #xfd7046c5 3)    (op2 #xb55a4f09 -16))))
